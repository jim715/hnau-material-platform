import{M as Xe,c as x,a as r,b as l,w as o,v as $,d as N,G as ce,E as Ce,f as i,e as f,y as Ye,u as Ze,g as _,l as V,p as Qe,W as el,X as ll,q as al,x as ol,n as tl,h as u,Y as me,t as g,H as sl,Z as nl,_ as rl,$ as ul,B as dl}from"./index-C2Rltc0A.js";import{a as c}from"./index-CzZzTWyT.js";import{r as il,u as pl}from"./xlsx-BUW7exb-.js";import{_ as vl}from"./_plugin-vue_export-helper-DlAUqK2U.js";const cl={class:"admin-container"},ml={class:"admin-menu"},gl={class:"admin-content"},fl={key:0},yl={class:"login-records mt-6"},_l={key:1},wl=["onClick"],bl={key:1,class:"no-data"},Il={key:2},kl={key:3},Vl={key:0,class:"no-data"},Cl={key:4},Tl={class:"update-settings"},Dl={class:"update-buttons"},hl={key:5},Sl={class:"dialog-footer"},Ul={class:"dialog-footer"},xl={class:"material-detail"},Rl={class:"description"},Al={class:"file-info"},Ll={class:"dialog-footer"},Pl={class:"integral-dialog"},Ml={class:"integral-actions"},Fl={class:"dialog-footer"},$l={__name:"Admin",setup(zl){const ge=Ze();console.log("API模块:",c),console.log("API基础URL:",c.defaults.baseURL);const F=i(""),q=i(null),s=i(""),n=i("info"),j=i([]),X=i(!1),fe=i(1),Y=i(!1),b=i({}),ne=i([]),G=i(!1),J=i(!1),C=i({name:"",description:"",parentId:0,sort:0}),T=i({id:"",name:"",description:"",parentId:0,sort:0}),Te=i({name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]}),De=i({name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]}),re=i([]),Z=i(!1),z=i(!1),A=i({}),L=i({points:0,reason:""}),he=i({points:[{required:!0,message:"请输入积分变动值",trigger:"blur"}],reason:[{required:!0,message:"请输入变动原因",trigger:"blur"}]}),h=i([]),ue=i(!1),P=i(0),O=i(1),B=i(null),I=i({updateDate:new Date,startTime:new Date,endTime:new Date}),Se=i({updateDate:[{required:!0,message:"请选择更新日期",trigger:"change"}],startTime:[{required:!0,message:"请选择开始时间",trigger:"change"}],endTime:[{required:!0,message:"请选择结束时间",trigger:"change"}]}),de=i(null),M=i(!1),k=i(""),D=i("info"),R=i(null),E=i(null),Ue=(a,e)=>{console.log("菜单选择:",a),F.value=a,a==="category-manage"?ee():a==="material-manage"?ie():a==="integral-manage"?(console.log("选择了积分管理，准备获取用户列表..."),console.log("localStorage中的token:",localStorage.getItem("token")),console.log("localStorage中的user:",localStorage.getItem("user")),le()):a==="user-manage"&&Oe()},xe=async()=>{try{console.log("Admin页面开始退出登录...");const a=await c.post("/user/logout");console.log("退出登录响应:",a),console.log("强制刷新登录记录...");const e=await c.get("/admin/login/records",{params:{page:O.value,pageSize:10}});console.log("强制刷新登录记录成功:",e),e.code===200&&e.data&&e.data.list&&(h.value=e.data.list,P.value=e.data.total||0,console.log("Admin页面登录记录已更新")),console.log("等待2秒，让用户看到更新后的退出时间..."),await new Promise(d=>setTimeout(d,2e3)),console.log("等待完成，准备清除token并跳转..."),localStorage.removeItem("user"),localStorage.removeItem("token"),Ce.success("退出登录成功"),ge.push("/login")}catch(a){console.error("退出登录失败:",a),localStorage.removeItem("user"),localStorage.removeItem("token"),Ce.success("退出登录成功"),ge.push("/login")}};window.handleAdminLogout=xe;const ie=async()=>{X.value=!0;try{const a=await c.get("/admin/material/audit/list");a.code===200?j.value=a.data:(s.value="获取待审核资料失败: "+(a.message||"未知错误"),n.value="error")}catch(a){console.error("获取待审核资料失败:",a),s.value="获取待审核资料失败，请检查网络连接",n.value="error"}finally{X.value=!1}},ye=async(a,e)=>{try{const d=await c.post("/admin/material/audit",{materialId:a,auditStatus:e});d.code===200?(s.value="审核成功",n.value="success",ie()):(s.value="审核失败: "+(d.message||"未知错误"),n.value="error")}catch(d){console.error("审核资料失败:",d),s.value="审核资料失败，请检查网络连接",n.value="error"}},Re=async a=>{try{const e=await c.get(`/material/info/${a.id}`);e.code===200?(b.value=e.data,Y.value=!0):(s.value="获取资料详情失败: "+(e.message||"未知错误"),n.value="error")}catch(e){console.error("获取资料详情失败:",e),s.value="获取资料详情失败，请检查网络连接",n.value="error"}},Q=a=>a?new Date(a).toLocaleString():"",Ae=a=>{if(!a)return"0 B";const e=1024,d=["B","KB","MB","GB","TB"],m=Math.floor(Math.log(a)/Math.log(e));return parseFloat((a/Math.pow(e,m)).toFixed(2))+" "+d[m]},Le=a=>{fe.value=a},ee=async()=>{try{const a=await c.get("/category/list");a.code===200?ne.value=a.data:(s.value="获取分类列表失败",n.value="error")}catch(a){console.error("获取分类列表失败:",a),s.value="获取分类列表失败",n.value="error"}},Pe=()=>{C.value={name:"",description:"",parentId:0,sort:0},G.value=!0},Me=a=>{T.value={id:a.id,name:a.name,description:a.description,parentId:a.parentId,sort:a.sort},J.value=!0},Fe=async()=>{try{const a=await c.post("/category/create",C.value);a.code===200?(s.value="添加分类成功",n.value="success",G.value=!1,ee()):(s.value="添加分类失败: "+(a.message||"未知错误"),n.value="error")}catch(a){console.error("添加分类失败:",a),s.value="添加分类失败",n.value="error"}},$e=async()=>{try{const a=await c.put("/category/update",T.value);a.code===200?(s.value="编辑分类成功",n.value="success",J.value=!1,ee()):(s.value="编辑分类失败: "+(a.message||"未知错误"),n.value="error")}catch(a){console.error("编辑分类失败:",a),s.value="编辑分类失败",n.value="error"}},ze=async a=>{try{const e=await c.delete(`/category/delete/${a}`);e.code===200?(s.value="删除分类成功",n.value="success",ee()):(s.value="删除分类失败: "+(e.message||"未知错误"),n.value="error")}catch(e){console.error("删除分类失败:",e),s.value="删除分类失败",n.value="error"}},Be=(a,e)=>{q.value=a.raw,s.value=""},Ee=async()=>{if(!q.value){s.value="请先选择Excel文件",n.value="warning";return}const a=new FileReader;a.onload=async e=>{try{console.log("开始解析Excel文件");const d=new Uint8Array(e.target.result);console.log("读取文件数据成功，长度:",d.length);const m=il(d,{type:"array"});console.log("解析工作簿成功，工作表数量:",m.SheetNames.length);const oe=m.SheetNames[0];console.log("使用工作表:",oe);const v=m.Sheets[oe];console.log("获取工作表成功");const H=pl.sheet_to_json(v);console.log("转换为JSON数据成功，行数:",H.length),console.log("JSON数据:",H);const K=H.map(y=>({studentId:y.studentId||y.学号||"",name:y.name||y.姓名||"",grade:y.grade||y.年级||"",major:y.major||y.专业||"",college:y.college||y.学院||""})).filter(y=>y.studentId&&y.name);if(console.log("转换后的用户数据:",K),K.length===0){s.value="Excel文件中没有有效的学生信息",n.value="warning";return}console.log("开始发送批量创建用户请求");const p=await c.post("/admin/user/batch",K);console.log("批量创建用户请求成功，响应:",p),p.code===200?(s.value="学生信息上传成功",n.value="success",q.value=null):(s.value="学生信息上传失败: "+(p.message||"未知错误"),n.value="error")}catch(d){console.error("解析Excel文件失败:",d),console.error("错误堆栈:",d.stack),s.value="解析Excel文件失败，请检查文件格式: "+d.message+`
错误堆栈: `+d.stack,n.value="error"}},a.onerror=e=>{console.error("文件读取失败:",e),console.error("错误堆栈:",e.stack),s.value="文件读取失败，请检查文件: "+e.message,n.value="error"},a.readAsArrayBuffer(q.value)},le=async()=>{Z.value=!0;try{console.log("开始获取用户列表..."),console.log("API请求URL:","/admin/user/list"),console.log("API基础URL:",c.defaults.baseURL);const a=c.defaults.baseURL+"/admin/user/list";console.log("完整请求URL:",a),console.log("localStorage中的token:",localStorage.getItem("token")),console.log("localStorage中的user:",localStorage.getItem("user"));const e=await c.get("/admin/user/list");console.log("获取用户列表响应:",e),e.code===200?(console.log("获取用户列表成功，数据:",e.data),re.value=e.data):(console.error("获取用户列表失败:",e.message||"未知错误"),s.value="获取用户列表失败: "+(e.message||"未知错误"),n.value="error")}catch(a){console.error("获取用户列表异常:",a),console.error("异常详情:",a.response),console.error("异常消息:",a.message),s.value="获取用户列表失败，请检查网络连接",n.value="error"}finally{Z.value=!1}},Ne=a=>{A.value=a,L.value={points:0,reason:""},z.value=!0},qe=async()=>{try{const a=await c.post("/admin/integral/update",{userId:A.value.id,points:L.value.points,reason:L.value.reason});a.code===200?(s.value="积分修改成功",n.value="success",z.value=!1,le()):(s.value="积分修改失败: "+(a.message||"未知错误"),n.value="error")}catch(a){console.error("修改积分失败:",a),s.value="修改积分失败，请检查网络连接",n.value="error"}},je=async()=>{try{const a=await c.post("/admin/integral/clear",{userId:A.value.id});a.code===200?(s.value="积分清除成功",n.value="success",z.value=!1,le()):(s.value="积分清除失败: "+(a.message||"未知错误"),n.value="error")}catch(a){console.error("清除积分失败:",a),s.value="清除积分失败，请检查网络连接",n.value="error"}},Ge=async()=>{try{console.log("开始测试API...");const a=await c.get("/admin/test");console.log("测试API响应:",a),a.code===200?(s.value="测试API调用成功",n.value="success"):(s.value="测试API调用失败: "+(a.message||"未知错误"),n.value="error")}catch(a){console.error("测试API异常:",a),s.value="测试API调用失败，请检查网络连接",n.value="error"}},ae=async()=>{ue.value=!0;try{console.log("开始获取登录记录..."),console.log("请求参数:",{page:O.value,pageSize:10});const a=localStorage.getItem("token");if(console.log("使用的token:",a),!a){console.error("未登录，token为空"),s.value="获取登录记录失败: 未登录",n.value="error",h.value=[],P.value=0,_e();return}const e=await c.get("/admin/login/records",{params:{page:O.value,pageSize:10}});console.log("登录记录响应:",e),console.log("响应类型:",typeof e),e&&e.code===200?e.data?(console.log("响应data:",e.data),e.data.list?(console.log("获取登录记录成功，记录数:",e.data.list.length),h.value=e.data.list,P.value=e.data.total||0,s.value=""):(console.error("响应data中没有list字段"),s.value="获取登录记录失败: 数据结构不正确",n.value="error",h.value=[],P.value=0)):(console.error("响应中没有data字段"),s.value="获取登录记录失败: 数据结构不正确",n.value="error",h.value=[],P.value=0):(console.error("响应code不是200:",e==null?void 0:e.code),s.value="获取登录记录失败: "+((e==null?void 0:e.message)||"未知错误"),n.value="error",h.value=[],P.value=0)}catch(a){console.error("获取登录记录失败:",a),console.error("错误消息:",a.message),console.error("错误堆栈:",a.stack),s.value="获取登录记录失败，请检查网络连接",n.value="error",h.value=[],P.value=0}finally{ue.value=!1}},Je=a=>{O.value=a,ae()},Oe=()=>{B.value&&clearInterval(B.value),ae(),B.value=setInterval(()=>{ae()},5e3),console.log("登录记录自动刷新已启动")},_e=()=>{B.value&&(clearInterval(B.value),B.value=null,console.log("登录记录自动刷新已停止"))},He=async()=>{de.value&&await de.value.validate(async a=>{if(a)try{const e=new Date(I.value.startTime),d=new Date,m=e.getTime()-d.getTime();console.log("开始时间:",e),console.log("当前时间:",d),console.log("开始时间差(毫秒):",m),m>0?(k.value=`系统将在 ${e.toLocaleString()} 开始更新`,D.value="info",E.value&&clearTimeout(E.value),E.value=setTimeout(async()=>{console.log("到达开始时间，自动执行开始更新..."),await we()},m),console.log("开始更新定时器已设置，将在",e,"自动执行")):await we()}catch(e){console.error("系统更新开始失败:",e),k.value="系统更新开始失败，请检查网络连接",D.value="error",M.value=!1}})},we=async()=>{try{M.value=!0,k.value="系统开始更新，正在强制所有用户退出...",D.value="warning",console.log("开始强制所有用户退出...");const a=await c.post("/admin/system/update/start",{updateDate:I.value.updateDate,startTime:I.value.startTime,endTime:I.value.endTime});if(a.code===200){k.value="系统更新开始成功，所有用户已被强制退出",D.value="success",console.log("系统更新开始成功，管理员可以继续操作"),console.log("设置更新完成定时器...");const e=new Date(I.value.endTime),d=new Date,m=e.getTime()-d.getTime();m>0?(console.log("结束时间:",e),console.log("当前时间:",d),console.log("结束时间差(毫秒):",m),R.value&&clearTimeout(R.value),R.value=setTimeout(async()=>{console.log("到达结束时间，自动调用更新完成方法..."),await pe()},m),console.log("更新完成定时器已设置，将在",e,"自动执行")):(console.log("结束时间已过，立即调用更新完成方法..."),await pe())}else k.value="系统更新开始失败: "+(a.message||"未知错误"),D.value="error",M.value=!1}catch(a){console.error("系统更新执行失败:",a),k.value="系统更新执行失败，请检查网络连接",D.value="error",M.value=!1}},pe=async()=>{try{k.value="正在完成系统更新...",D.value="info",R.value&&(clearTimeout(R.value),R.value=null,console.log("更新完成定时器已清除")),console.log("完成系统更新...");const a=await c.post("/admin/system/update/complete");a.code===200?(k.value="系统更新完成，所有功能已恢复正常",D.value="success",M.value=!1):(k.value="系统更新完成失败: "+(a.message||"未知错误"),D.value="error")}catch(a){console.error("系统更新完成失败:",a),k.value="系统更新完成失败，请检查网络连接",D.value="error"}};return Xe(()=>{_e(),R.value&&(clearTimeout(R.value),R.value=null,console.log("更新完成定时器已清除")),E.value&&(clearTimeout(E.value),E.value=null,console.log("开始更新定时器已清除")),console.log("Admin组件已卸载，定时器已清理")}),(a,e)=>{const d=f("el-icon"),m=f("el-menu-item"),oe=f("el-menu"),v=f("el-button"),H=f("el-upload"),K=f("el-alert"),p=f("el-table-column"),y=f("el-table"),be=f("el-pagination"),Ie=f("el-empty"),Ke=f("el-date-picker"),w=f("el-form-item"),ke=f("el-time-picker"),te=f("el-form"),We=f("el-card"),S=f("el-input"),se=f("el-dialog"),U=f("el-descriptions-item"),Ve=f("el-descriptions"),ve=Ye("loading");return _(),x("div",cl,[r("div",ml,[l(oe,{"default-active":F.value,class:"el-menu-vertical-demo",onSelect:Ue},{default:o(()=>[l(m,{index:"user-manage"},{default:o(()=>[l(d,null,{default:o(()=>[l(V(Qe))]),_:1}),e[21]||(e[21]=r("span",null,"用户管理",-1))]),_:1}),l(m,{index:"material-manage"},{default:o(()=>[l(d,null,{default:o(()=>[l(V(el))]),_:1}),e[22]||(e[22]=r("span",null,"资料管理",-1))]),_:1}),l(m,{index:"category-manage"},{default:o(()=>[l(d,null,{default:o(()=>[l(V(ll))]),_:1}),e[23]||(e[23]=r("span",null,"分类管理",-1))]),_:1}),l(m,{index:"integral-manage"},{default:o(()=>[l(d,null,{default:o(()=>[l(V(al))]),_:1}),e[24]||(e[24]=r("span",null,"积分管理",-1))]),_:1}),l(m,{index:"system-setting"},{default:o(()=>[l(d,null,{default:o(()=>[l(V(ol))]),_:1}),e[25]||(e[25]=r("span",null,"系统设置",-1))]),_:1})]),_:1},8,["default-active"])]),r("div",gl,[F.value==="user-manage"?(_(),x("div",fl,[e[31]||(e[31]=r("h2",null,"用户管理",-1)),l(H,{class:"user-upload",action:"","on-change":Be,"auto-upload":!1,accept:".xlsx, .xls",multiple:""},{tip:o(()=>[...e[27]||(e[27]=[r("div",{class:"el-upload__tip"}," 请上传包含学生信息的Excel文件，支持.xlsx和.xls格式 ",-1)])]),default:o(()=>[l(v,{type:"primary"},{default:o(()=>[l(d,null,{default:o(()=>[l(V(tl))]),_:1}),e[26]||(e[26]=u(" 上传学生信息Excel文件 ",-1))]),_:1})]),_:1}),l(v,{type:"success",onClick:Ee,disabled:!q.value},{default:o(()=>[...e[28]||(e[28]=[u(" 确认上传 ",-1)])]),_:1},8,["disabled"]),s.value?(_(),$(K,{key:0,title:s.value,type:n.value,"show-icon":"",class:"mt-4"},null,8,["title","type"])):N("",!0),r("div",yl,[e[30]||(e[30]=r("h3",null,"登录记录",-1)),l(v,{type:"primary",onClick:ae,class:"mb-4"},{default:o(()=>[l(d,null,{default:o(()=>[l(V(me))]),_:1}),e[29]||(e[29]=u(" 刷新登录记录 ",-1))]),_:1}),ce((_(),$(y,{data:h.value,style:{width:"100%"}},{default:o(()=>[l(p,{prop:"id",label:"ID",width:"80"}),l(p,{prop:"username",label:"用户名",width:"120"}),l(p,{prop:"studentId",label:"学号",width:"150"}),l(p,{prop:"loginTime",label:"登录时间",width:"180"},{default:o(t=>[u(g(Q(t.row.loginTime)),1)]),_:1}),l(p,{prop:"device",label:"登录设备","min-width":"200"}),l(p,{prop:"ipAddress",label:"IP地址",width:"150"}),l(p,{prop:"logoutTime",label:"退出时间",width:"180"},{default:o(t=>[u(g(t.row.logoutTime?Q(t.row.logoutTime):"-"),1)]),_:1}),l(p,{prop:"status",label:"状态",width:"100"},{default:o(t=>[u(g(t.row.status===0?"在线":"已退出"),1)]),_:1})]),_:1},8,["data"])),[[ve,ue.value]]),h.value&&h.value.length>0?(_(),$(be,{key:0,layout:"prev, pager, next",total:P.value,"page-size":10,"current-page":O.value,onCurrentChange:Je,class:"mt-4"},null,8,["total","current-page"])):N("",!0)])])):F.value==="material-manage"?(_(),x("div",_l,[e[35]||(e[35]=r("h2",null,"资料管理",-1)),l(v,{type:"primary",onClick:ie},{default:o(()=>[l(d,null,{default:o(()=>[l(V(me))]),_:1}),e[32]||(e[32]=u(" 刷新待审核列表 ",-1))]),_:1}),ce((_(),$(y,{data:j.value,style:{width:"100%"}},{default:o(()=>[l(p,{prop:"id",label:"ID",width:"80"}),l(p,{prop:"name",label:"资料名称","min-width":"200"},{default:o(t=>[r("a",{href:"#",onClick:sl(W=>Re(t.row),["prevent"])},g(t.row.name),9,wl)]),_:1}),l(p,{prop:"categoryId",label:"分类ID",width:"100"}),l(p,{prop:"userId",label:"上传用户ID",width:"120"}),l(p,{prop:"createTime",label:"上传时间",width:"180"},{default:o(t=>[u(g(Q(t.row.createTime)),1)]),_:1}),l(p,{label:"操作",width:"180"},{default:o(t=>[l(v,{type:"success",size:"small",onClick:W=>ye(t.row.id,1)},{default:o(()=>[...e[33]||(e[33]=[u(" 通过 ",-1)])]),_:1},8,["onClick"]),l(v,{type:"danger",size:"small",onClick:W=>ye(t.row.id,2)},{default:o(()=>[...e[34]||(e[34]=[u(" 驳回 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ve,X.value]]),j.value.length>0?(_(),$(be,{key:0,layout:"prev, pager, next",total:j.value.length,"page-size":10,"current-page":fe.value,onCurrentChange:Le,class:"mt-4"},null,8,["total","current-page"])):N("",!0),j.value.length===0&&!X.value?(_(),x("div",bl,[l(Ie,{description:"暂无待审核资料"})])):N("",!0)])):F.value==="category-manage"?(_(),x("div",Il,[e[39]||(e[39]=r("h2",null,"分类管理",-1)),l(v,{type:"primary",onClick:Pe},{default:o(()=>[l(d,null,{default:o(()=>[l(V(nl))]),_:1}),e[36]||(e[36]=u(" 添加分类 ",-1))]),_:1}),(_(),$(y,{data:ne.value,style:{width:"100%"},key:ne.value.length},{default:o(()=>[l(p,{prop:"id",label:"分类ID",width:"80"}),l(p,{prop:"name",label:"分类名称"}),l(p,{prop:"description",label:"分类描述"}),l(p,{prop:"parentId",label:"父分类ID",width:"120"}),l(p,{prop:"sort",label:"排序",width:"80"}),l(p,{label:"操作",width:"150"},{default:o(t=>[l(v,{type:"primary",size:"small",onClick:W=>Me(t.row)},{default:o(()=>[l(d,null,{default:o(()=>[l(V(rl))]),_:1}),e[37]||(e[37]=u(" 编辑 ",-1))]),_:1},8,["onClick"]),l(v,{type:"danger",size:"small",onClick:W=>ze(t.row.id)},{default:o(()=>[l(d,null,{default:o(()=>[l(V(ul))]),_:1}),e[38]||(e[38]=u(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]))])):F.value==="integral-manage"?(_(),x("div",kl,[e[43]||(e[43]=r("h2",null,"积分管理",-1)),l(v,{type:"primary",onClick:le},{default:o(()=>[l(d,null,{default:o(()=>[l(V(me))]),_:1}),e[40]||(e[40]=u(" 刷新用户列表 ",-1))]),_:1}),l(v,{type:"success",onClick:Ge},{default:o(()=>[...e[41]||(e[41]=[u(" 测试API ",-1)])]),_:1}),ce((_(),$(y,{data:re.value,style:{width:"100%"}},{default:o(()=>[l(p,{prop:"id",label:"用户ID",width:"100"}),l(p,{prop:"studentId",label:"学号",width:"150"}),l(p,{prop:"name",label:"姓名",width:"120"}),l(p,{prop:"college",label:"学院"}),l(p,{prop:"major",label:"专业"}),l(p,{prop:"points",label:"当前积分",width:"120"}),l(p,{label:"操作",width:"180"},{default:o(t=>[l(v,{type:"primary",size:"small",onClick:W=>Ne(t.row)},{default:o(()=>[...e[42]||(e[42]=[u(" 操作积分 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ve,Z.value]]),re.value.length===0&&!Z.value?(_(),x("div",Vl,[l(Ie,{description:"暂无用户数据"})])):N("",!0)])):F.value==="system-setting"?(_(),x("div",Cl,[e[46]||(e[46]=r("h2",null,"系统设置",-1)),l(We,{class:"system-update-card"},{header:o(()=>[...e[44]||(e[44]=[r("div",{class:"card-header"},[r("span",null,"系统更新设置")],-1)])]),default:o(()=>[r("div",Tl,[l(te,{model:I.value,rules:Se.value,ref_key:"updateFormRef",ref:de},{default:o(()=>[l(w,{label:"更新日期",prop:"updateDate"},{default:o(()=>[l(Ke,{modelValue:I.value.updateDate,"onUpdate:modelValue":e[0]||(e[0]=t=>I.value.updateDate=t),type:"date",placeholder:"选择更新日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(w,{label:"开始时间",prop:"startTime"},{default:o(()=>[l(ke,{modelValue:I.value.startTime,"onUpdate:modelValue":e[1]||(e[1]=t=>I.value.startTime=t),placeholder:"选择开始时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(w,{label:"结束时间",prop:"endTime"},{default:o(()=>[l(ke,{modelValue:I.value.endTime,"onUpdate:modelValue":e[2]||(e[2]=t=>I.value.endTime=t),placeholder:"选择结束时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),r("div",Dl,[l(v,{type:"danger",onClick:He,disabled:M.value},{default:o(()=>[u(g(M.value?"更新中...":"开始更新"),1)]),_:1},8,["disabled"]),l(v,{type:"success",onClick:pe,disabled:!M.value},{default:o(()=>[...e[45]||(e[45]=[u(" 更新完成 ",-1)])]),_:1},8,["disabled"])]),k.value?(_(),x("div",{key:0,class:dl(["update-message",D.value])},g(k.value),3)):N("",!0)])]),_:1})])):(_(),x("div",hl,[...e[47]||(e[47]=[r("h2",null,"欢迎",-1),r("p",null,"请选择左侧菜单进行操作",-1)])])),l(se,{modelValue:G.value,"onUpdate:modelValue":e[8]||(e[8]=t=>G.value=t),title:"添加分类",width:"500px"},{footer:o(()=>[r("span",Sl,[l(v,{onClick:e[7]||(e[7]=t=>G.value=!1)},{default:o(()=>[...e[48]||(e[48]=[u("取消",-1)])]),_:1}),l(v,{type:"primary",onClick:Fe},{default:o(()=>[...e[49]||(e[49]=[u("确定",-1)])]),_:1})])]),default:o(()=>[l(te,{model:C.value,rules:Te.value,ref:"addCategoryFormRef"},{default:o(()=>[l(w,{label:"分类名称",prop:"name"},{default:o(()=>[l(S,{modelValue:C.value.name,"onUpdate:modelValue":e[3]||(e[3]=t=>C.value.name=t),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),l(w,{label:"分类描述",prop:"description"},{default:o(()=>[l(S,{modelValue:C.value.description,"onUpdate:modelValue":e[4]||(e[4]=t=>C.value.description=t),placeholder:"请输入分类描述",type:"textarea"},null,8,["modelValue"])]),_:1}),l(w,{label:"父分类ID",prop:"parentId"},{default:o(()=>[l(S,{modelValue:C.value.parentId,"onUpdate:modelValue":e[5]||(e[5]=t=>C.value.parentId=t),placeholder:"请输入父分类ID，根分类为0",type:"number"},null,8,["modelValue"])]),_:1}),l(w,{label:"排序",prop:"sort"},{default:o(()=>[l(S,{modelValue:C.value.sort,"onUpdate:modelValue":e[6]||(e[6]=t=>C.value.sort=t),placeholder:"请输入排序",type:"number"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),l(se,{modelValue:J.value,"onUpdate:modelValue":e[14]||(e[14]=t=>J.value=t),title:"编辑分类",width:"500px"},{footer:o(()=>[r("span",Ul,[l(v,{onClick:e[13]||(e[13]=t=>J.value=!1)},{default:o(()=>[...e[50]||(e[50]=[u("取消",-1)])]),_:1}),l(v,{type:"primary",onClick:$e},{default:o(()=>[...e[51]||(e[51]=[u("确定",-1)])]),_:1})])]),default:o(()=>[l(te,{model:T.value,rules:De.value,ref:"editCategoryFormRef"},{default:o(()=>[l(w,{label:"分类名称",prop:"name"},{default:o(()=>[l(S,{modelValue:T.value.name,"onUpdate:modelValue":e[9]||(e[9]=t=>T.value.name=t),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),l(w,{label:"分类描述",prop:"description"},{default:o(()=>[l(S,{modelValue:T.value.description,"onUpdate:modelValue":e[10]||(e[10]=t=>T.value.description=t),placeholder:"请输入分类描述",type:"textarea"},null,8,["modelValue"])]),_:1}),l(w,{label:"父分类ID",prop:"parentId"},{default:o(()=>[l(S,{modelValue:T.value.parentId,"onUpdate:modelValue":e[11]||(e[11]=t=>T.value.parentId=t),placeholder:"请输入父分类ID，根分类为0",type:"number"},null,8,["modelValue"])]),_:1}),l(w,{label:"排序",prop:"sort"},{default:o(()=>[l(S,{modelValue:T.value.sort,"onUpdate:modelValue":e[12]||(e[12]=t=>T.value.sort=t),placeholder:"请输入排序",type:"number"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),l(se,{modelValue:Y.value,"onUpdate:modelValue":e[16]||(e[16]=t=>Y.value=t),title:b.value.name||"资料详情",width:"80%"},{footer:o(()=>[r("span",Ll,[l(v,{onClick:e[15]||(e[15]=t=>Y.value=!1)},{default:o(()=>[...e[54]||(e[54]=[u("关闭",-1)])]),_:1})])]),default:o(()=>[r("div",xl,[l(Ve,{column:2,border:""},{default:o(()=>[l(U,{label:"资料ID"},{default:o(()=>[u(g(b.value.id),1)]),_:1}),l(U,{label:"上传用户ID"},{default:o(()=>[u(g(b.value.userId),1)]),_:1}),l(U,{label:"分类ID"},{default:o(()=>[u(g(b.value.categoryId),1)]),_:1}),l(U,{label:"上传时间"},{default:o(()=>[u(g(Q(b.value.createTime)),1)]),_:1}),l(U,{label:"文件大小"},{default:o(()=>[u(g(Ae(b.value.fileSize)),1)]),_:1}),l(U,{label:"审核状态"},{default:o(()=>[u(g(b.value.auditStatus===0?"待审核":b.value.auditStatus===1?"已通过":"已驳回"),1)]),_:1})]),_:1}),r("div",Rl,[e[52]||(e[52]=r("h3",null,"资料描述",-1)),r("p",null,g(b.value.description||"无描述"),1)]),r("div",Al,[e[53]||(e[53]=r("h3",null,"文件信息",-1)),r("p",null,"文件路径: "+g(b.value.filePath),1),r("p",null,"文件名: "+g(b.value.fileName),1)])])]),_:1},8,["modelValue","title"]),l(se,{modelValue:z.value,"onUpdate:modelValue":e[20]||(e[20]=t=>z.value=t),title:`积分操作 - ${A.value.name||""}`,width:"500px"},{footer:o(()=>[r("span",Fl,[l(v,{onClick:e[19]||(e[19]=t=>z.value=!1)},{default:o(()=>[...e[56]||(e[56]=[u("取消",-1)])]),_:1}),l(v,{type:"primary",onClick:qe},{default:o(()=>[...e[57]||(e[57]=[u("改变积分",-1)])]),_:1}),l(v,{type:"danger",onClick:je},{default:o(()=>[...e[58]||(e[58]=[u("清除积分",-1)])]),_:1})])]),default:o(()=>[r("div",Pl,[l(Ve,{column:2,border:""},{default:o(()=>[l(U,{label:"用户ID"},{default:o(()=>[u(g(A.value.id),1)]),_:1}),l(U,{label:"学号"},{default:o(()=>[u(g(A.value.studentId),1)]),_:1}),l(U,{label:"姓名"},{default:o(()=>[u(g(A.value.name),1)]),_:1}),l(U,{label:"当前积分"},{default:o(()=>[u(g(A.value.points||0),1)]),_:1})]),_:1}),r("div",Ml,[e[55]||(e[55]=r("h3",null,"操作选项",-1)),l(te,{model:L.value,rules:he.value,ref:"integralFormRef"},{default:o(()=>[l(w,{label:"改变积分",prop:"points"},{default:o(()=>[l(S,{modelValue:L.value.points,"onUpdate:modelValue":e[17]||(e[17]=t=>L.value.points=t),placeholder:"请输入积分变动值（正数增加，负数减少）",type:"number"},null,8,["modelValue"])]),_:1}),l(w,{label:"变动原因",prop:"reason"},{default:o(()=>[l(S,{modelValue:L.value.reason,"onUpdate:modelValue":e[18]||(e[18]=t=>L.value.reason=t),placeholder:"请输入积分变动原因"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])])]),_:1},8,["modelValue","title"])])])}}},jl=vl($l,[["__scopeId","data-v-b0e37745"]]);export{jl as default};
