import{a as y}from"./index-CKeea3vE.js";import{_ as h}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as k,b as e,w as a,e as r,g as F,a as f,h as v,f as b,r as I,E as i}from"./index-15cpDDQA.js";const B={class:"question-add"},C={class:"add-content"},N={__name:"QuestionAdd",setup(A){const o=I({title:"",content:"",tags:[]}),V={title:[{required:!0,message:"请输入问题标题",trigger:"blur"},{min:5,max:100,message:"标题长度应在5-100个字符之间",trigger:"blur"}],content:[{required:!0,message:"请输入问题内容",trigger:"blur"},{min:10,max:1e3,message:"内容长度应在10-1000个字符之间",trigger:"blur"}],tags:[{required:!0,message:"请至少选择一个标签",trigger:"blur"}]},m=b(null),n=b(!1),w=async()=>{await m.value.validate(async(g,t)=>{if(g){n.value=!0;try{const s=localStorage.getItem("user");if(!s){i.error("请先登录"),n.value=!1;return}const l=JSON.parse(s).id,c=localStorage.getItem("token");if(!c){i.error("请先登录"),n.value=!1;return}const p={title:o.title,content:o.content,tags:o.tags.join(","),userId:l},_=await y.post("/question/add",p,{headers:{Authorization:`Bearer ${c}`}});_.code===200?(i.success("问题发布成功，获得5积分"),m.value.resetFields()):i.error(_.message||"问题发布失败")}catch(s){console.error("问题发布失败:",s),i.error("问题发布失败，请检查网络连接")}finally{n.value=!1}}else console.log("验证失败:",t)})},x=()=>{m.value.resetFields()};return(g,t)=>{const s=r("el-input"),u=r("el-form-item"),l=r("el-option"),c=r("el-select"),p=r("el-button"),_=r("el-form"),q=r("el-card");return F(),k("div",B,[e(q,{class:"add-card"},{header:a(()=>[...t[3]||(t[3]=[f("div",{class:"card-header"},[f("span",null,"发布问题")],-1)])]),default:a(()=>[f("div",C,[e(_,{model:o,rules:V,ref_key:"questionFormRef",ref:m,"label-width":"80px"},{default:a(()=>[e(u,{label:"问题标题",prop:"title"},{default:a(()=>[e(s,{modelValue:o.title,"onUpdate:modelValue":t[0]||(t[0]=d=>o.title=d),placeholder:"请输入问题标题",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(u,{label:"问题内容",prop:"content"},{default:a(()=>[e(s,{modelValue:o.content,"onUpdate:modelValue":t[1]||(t[1]=d=>o.content=d),type:"textarea",rows:6,placeholder:"请详细描述您的问题",maxlength:"1000","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(u,{label:"标签",prop:"tags"},{default:a(()=>[e(c,{modelValue:o.tags,"onUpdate:modelValue":t[2]||(t[2]=d=>o.tags=d),multiple:"",placeholder:"请选择标签",style:{width:"100%"}},{default:a(()=>[e(l,{label:"课程学习",value:"课程学习"}),e(l,{label:"考试复习",value:"考试复习"}),e(l,{label:"编程开发",value:"编程开发"}),e(l,{label:"算法数据结构",value:"算法数据结构"}),e(l,{label:"前端技术",value:"前端技术"}),e(l,{label:"后端技术",value:"后端技术"}),e(l,{label:"数据库",value:"数据库"}),e(l,{label:"计算机网络",value:"计算机网络"}),e(l,{label:"操作系统",value:"操作系统"}),e(l,{label:"软件工程",value:"软件工程"})]),_:1},8,["modelValue"])]),_:1}),e(u,null,{default:a(()=>[e(p,{type:"primary",onClick:w,loading:n.value},{default:a(()=>[...t[4]||(t[4]=[v("发布问题",-1)])]),_:1},8,["loading"]),e(p,{onClick:x},{default:a(()=>[...t[5]||(t[5]=[v("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1})])}}},Q=h(N,[["__scopeId","data-v-876a7005"]]);export{Q as default};
