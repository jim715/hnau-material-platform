<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hnau.platform.mapper.LoginRecordMapper">

    <!-- 获取所有登录记录（分页） -->
    <select id="getLoginRecords" resultType="com.hnau.platform.entity.LoginRecord">
        SELECT * FROM login_record
        WHERE user_id != 1
        ORDER BY login_time DESC
        LIMIT #{offset}, #{limit}
    </select>

    <!-- 获取指定用户的登录记录（分页） -->
    <select id="getLoginRecordsByUserId" resultType="com.hnau.platform.entity.LoginRecord">
        SELECT * FROM login_record
        WHERE user_id = #{userId}
        ORDER BY login_time DESC
        LIMIT #{offset}, #{limit}
    </select>

    <!-- 获取登录记录总数 -->
    <select id="getLoginRecordsCount" resultType="java.lang.Integer">
        SELECT COUNT(*) FROM login_record
        WHERE user_id != 1
    </select>

    <!-- 获取指定用户的登录记录总数 -->
    <select id="getLoginRecordsCountByUserId" resultType="java.lang.Integer">
        SELECT COUNT(*) FROM login_record
        WHERE user_id = #{userId}
    </select>

    <!-- 获取用户的最新登录记录 -->
    <select id="getLatestLoginRecordByUserId" resultType="com.hnau.platform.entity.LoginRecord">
        SELECT * FROM login_record
        WHERE user_id = #{userId}
        ORDER BY login_time DESC
        LIMIT 1
    </select>

    <!-- 获取用户所有状态为在线的登录记录 -->
    <select id="getOnlineLoginRecordsByUserId" resultType="com.hnau.platform.entity.LoginRecord">
        SELECT * FROM login_record
        WHERE user_id = #{userId} AND status = 0
        ORDER BY login_time DESC
    </select>

    <!-- 获取所有用户所有状态为在线的登录记录 -->
    <select id="getAllOnlineLoginRecords" resultType="com.hnau.platform.entity.LoginRecord">
        SELECT * FROM login_record
        WHERE status = 0
        ORDER BY login_time DESC
    </select>

</mapper>
